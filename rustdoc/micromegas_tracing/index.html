<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="High-performance tracing for logs, metrics, and spans."><title>micromegas_tracing - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-ca0dd0c4.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="micromegas_tracing" data-themes="" data-resource-suffix="" data-rustdoc-version="1.93.1 (01f6ddf75 2026-02-11)" data-channel="1.93.1" data-search-js="search-9e2438ea.js" data-stringdex-js="stringdex-a3946164.js" data-settings-js="settings-c38705f0.js" ><script src="../static.files/storage-e2aeef58.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-a410ff4d.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">Crate micromegas_tracing</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../micromegas_tracing/index.html">micromegas_<wbr>tracing</a><span class="version">0.21.0</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section id="rustdoc-toc"><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#quick-start---instrumenting-functions" title="Quick Start - Instrumenting Functions">Quick Start - Instrumenting Functions</a></li><li><a href="#logging" title="Logging">Logging</a></li><li><a href="#metrics" title="Metrics">Metrics</a></li><li><a href="#manual-span-scopes" title="Manual Span Scopes">Manual Span Scopes</a></li><li><a href="#initialization" title="Initialization">Initialization</a></li><li><a href="#architecture" title="Architecture">Architecture</a></li></ul><h3><a href="#modules">Crate Items</a></h3><ul class="block"><li><a href="#modules" title="Modules">Modules</a></li><li><a href="#macros" title="Macros">Macros</a></li></ul></section><div id="rustdoc-modnav"></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><h1>Crate <span>micromegas_<wbr>tracing</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/micromegas_tracing/lib.rs.html#1-176">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>High-performance tracing for logs, metrics, and spans.</p>
<p>This crate provides low-overhead instrumentation (~20ns per event) for high-performance
applications. Originally designed for video game engines, it focuses on predictable
performance while providing comprehensive observability.</p>
<h2 id="quick-start---instrumenting-functions"><a class="doc-anchor" href="#quick-start---instrumenting-functions">§</a>Quick Start - Instrumenting Functions</h2>
<p>The easiest way to instrument your code is with the <a href="prelude/attr.span_fn.html" title="attr micromegas_tracing::prelude::span_fn"><code>#[span_fn]</code></a> attribute macro:</p>

<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="kw">use </span>micromegas_tracing::prelude::<span class="kw-2">*</span>;

<span class="attr">#[span_fn]
</span><span class="kw">async fn </span>fetch_user(id: u64) -&gt; User {
    <span class="comment">// Automatically tracks execution time, even across .await points
    </span>database.get_user(id).<span class="kw">await
</span>}

<span class="attr">#[span_fn]
</span><span class="kw">fn </span>compute_hash(data: <span class="kw-2">&amp;</span>[u8]) -&gt; Hash {
    <span class="comment">// Works for sync functions too
    </span>hasher.hash(data)
}</code></pre></div>
<p><a href="prelude/attr.span_fn.html" title="attr micromegas_tracing::prelude::span_fn"><code>#[span_fn]</code></a> is the primary tool for instrumenting async code. It correctly tracks
wall-clock time across await points by wrapping the future in an <a href="spans/struct.InstrumentedFuture.html" title="struct micromegas_tracing::spans::InstrumentedFuture"><code>InstrumentedFuture</code></a>.</p>
<h2 id="logging"><a class="doc-anchor" href="#logging">§</a>Logging</h2>
<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="kw">use </span>micromegas_tracing::prelude::<span class="kw-2">*</span>;

<span class="macro">info!</span>(<span class="string">"User logged in"</span>);
<span class="macro">warn!</span>(<span class="string">"Connection timeout"</span>);
<span class="macro">error!</span>(<span class="string">"Failed to process request"</span>);
<span class="macro">debug!</span>(<span class="string">"Debug info: {value}"</span>);
<span class="macro">trace!</span>(<span class="string">"Detailed trace"</span>);</code></pre></div><h2 id="metrics"><a class="doc-anchor" href="#metrics">§</a>Metrics</h2>
<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="kw">use </span>micromegas_tracing::prelude::<span class="kw-2">*</span>;

<span class="macro">imetric!</span>(<span class="string">"requests_total"</span>, <span class="string">"count"</span>, <span class="number">1</span>);
<span class="macro">fmetric!</span>(<span class="string">"response_time"</span>, <span class="string">"ms"</span>, elapsed_ms);</code></pre></div><h2 id="manual-span-scopes"><a class="doc-anchor" href="#manual-span-scopes">§</a>Manual Span Scopes</h2>
<p>For fine-grained control within a function, use <a href="macro.span_scope.html" title="macro micromegas_tracing::span_scope"><code>span_scope!</code></a>:</p>

<div class="example-wrap ignore"><a href="#" class="tooltip" title="This example is not tested">ⓘ</a><pre class="rust rust-example-rendered"><code><span class="kw">use </span>micromegas_tracing::prelude::<span class="kw-2">*</span>;

<span class="kw">fn </span>process_batch(items: <span class="kw-2">&amp;</span>[Item]) {
    <span class="macro">span_scope!</span>(<span class="string">"process_batch"</span>);

    <span class="kw">for </span>item <span class="kw">in </span>items {
        <span class="macro">span_scope!</span>(<span class="string">"process_item"</span>);
        <span class="comment">// Process each item...
    </span>}
}</code></pre></div><h2 id="initialization"><a class="doc-anchor" href="#initialization">§</a>Initialization</h2>
<p>Libraries should not initialize tracing - that’s the application’s responsibility.
Applications typically use <code>#[micromegas_main]</code> from the <code>micromegas</code> crate, or
manually set up guards:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>micromegas_tracing::{guards, event};

<span class="comment">// Application initialization (libraries should NOT do this)
</span><span class="kw">let </span>_tracing_guard = guards::TracingSystemGuard::new(
    <span class="number">8 </span>* <span class="number">1024 </span>* <span class="number">1024</span>,  <span class="comment">// log buffer size
    </span><span class="number">1024 </span>* <span class="number">1024</span>,      <span class="comment">// metrics buffer size
    </span><span class="number">16 </span>* <span class="number">1024 </span>* <span class="number">1024</span>, <span class="comment">// spans buffer size
    </span>std::sync::Arc::new(event::NullEventSink {}),
    std::collections::HashMap::new(),
    <span class="bool-val">true</span>, <span class="comment">// Enable CPU tracing
</span>);
<span class="kw">let </span>_thread_guard = guards::TracingThreadGuard::new();</code></pre></div><h2 id="architecture"><a class="doc-anchor" href="#architecture">§</a>Architecture</h2>
<p>Unlike other tracing crates, this library collects events into a stream rather than
providing per-event hooks. Events are serialized to a binary format using <code>transit</code>,
enabling efficient in-process buffering and network transmission.</p>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><dl class="item-table"><dt><a class="mod" href="dispatch/index.html" title="mod micromegas_tracing::dispatch">dispatch</a></dt><dd>Where events are recorded and eventually sent to a sink</dd><dt><a class="mod" href="errors/index.html" title="mod micromegas_tracing::errors">errors</a></dt><dd>Error types and handling for tracing operations</dd><dt><a class="mod" href="event/index.html" title="mod micromegas_tracing::event">event</a></dt><dd>Structure to record events in memory</dd><dt><a class="mod" href="flush_monitor/index.html" title="mod micromegas_tracing::flush_monitor">flush_<wbr>monitor</a></dt><dd>FlushMonitor triggers the flush of the telemetry streams at regular interval.</dd><dt><a class="mod" href="guards/index.html" title="mod micromegas_tracing::guards">guards</a></dt><dd>RAII-style guards</dd><dt><a class="mod" href="intern_string/index.html" title="mod micromegas_tracing::intern_string">intern_<wbr>string</a></dt><dd>Store dynamically-created strings in a global container.
Strings are never released from the container.</dd><dt><a class="mod" href="levels/index.html" title="mod micromegas_tracing::levels">levels</a></dt><dd>Verbosity management</dd><dt><a class="mod" href="logs/index.html" title="mod micromegas_tracing::logs">logs</a></dt><dd>Events representing a process’s log</dd><dt><a class="mod" href="metrics/index.html" title="mod micromegas_tracing::metrics">metrics</a></dt><dd>Events representing a measured scalar at a point in time</dd><dt><a class="mod" href="panic_hook/index.html" title="mod micromegas_tracing::panic_hook">panic_<wbr>hook</a></dt><dd>Reports panics as fatal log entries and shuts down the telemetry system</dd><dt><a class="mod" href="parsing/index.html" title="mod micromegas_tracing::parsing">parsing</a></dt><dd>Manual parsing of dynamically sized events</dd><dt><a class="mod" href="prelude/index.html" title="mod micromegas_tracing::prelude">prelude</a></dt><dd>Commonly used items for convenient importing - includes macros, types, and traits</dd><dt><a class="mod" href="process_info/index.html" title="mod micromegas_tracing::process_info">process_<wbr>info</a></dt><dd>Process metadata</dd><dt><a class="mod" href="property_set/index.html" title="mod micromegas_tracing::property_set">property_<wbr>set</a></dt><dd>Interned collection of PropertySet instances. Each PropertySet contains properties where the names and the values are statically allocated.
The user is expected to manage the cardinality.</dd><dt><a class="mod" href="runtime/index.html" title="mod micromegas_tracing::runtime">runtime</a></dt><dd>Runtime integration utilities for micromegas tracing</dd><dt><a class="mod" href="spans/index.html" title="mod micromegas_tracing::spans">spans</a></dt><dd>Events reprensenting units of code execution</dd><dt><a class="mod" href="static_string_ref/index.html" title="mod micromegas_tracing::static_string_ref">static_<wbr>string_<wbr>ref</a></dt><dd>StaticStringRef points to a string dependency keeping track of the codec.
Necessary for unreal instrumentation where ansi and wide strings can coexist.
In cases where the event format does not have to be compatible with unreal, StringId can be used.</dd><dt><a class="mod" href="string_id/index.html" title="mod micromegas_tracing::string_id">string_<wbr>id</a></dt><dd>StringId serializes the value of the pointer and the size of a UTF8 string.
StaticStringRef should be prefered where wire compatibility with unreal is important.</dd><dt><a class="mod" href="test_utils/index.html" title="mod micromegas_tracing::test_utils">test_<wbr>utils</a></dt><dd>Test utilities for in-memory tracing in unit tests</dd><dt><a class="mod" href="time/index.html" title="mod micromegas_tracing::time">time</a></dt><dd>System &amp; monotonic tick count</dd></dl><h2 id="macros" class="section-header">Macros<a href="#macros" class="anchor">§</a></h2><dl class="item-table"><dt><a class="macro" href="macro.debug.html" title="macro micromegas_tracing::debug">debug</a></dt><dd>Logs a message at the debug level.</dd><dt><a class="macro" href="macro.error.html" title="macro micromegas_tracing::error">error</a></dt><dd>Logs a message at the error level.</dd><dt><a class="macro" href="macro.fatal.html" title="macro micromegas_tracing::fatal">fatal</a></dt><dd>Logs a message representing a crash or panic</dd><dt><a class="macro" href="macro.fmetric.html" title="macro micromegas_tracing::fmetric">fmetric</a></dt><dd>Records a float metric.</dd><dt><a class="macro" href="macro.imetric.html" title="macro micromegas_tracing::imetric">imetric</a></dt><dd>Records a integer metric.</dd><dt><a class="macro" href="macro.info.html" title="macro micromegas_tracing::info">info</a></dt><dd>Logs a message at the info level.</dd><dt><a class="macro" href="macro.instrument_named.html" title="macro micromegas_tracing::instrument_named">instrument_<wbr>named</a></dt><dd>Instruments a future with a named span.
Usage: <code>instrument_named!(future, "span_name")</code></dd><dt><a class="macro" href="macro.log.html" title="macro micromegas_tracing::log">log</a></dt><dd>The standard logging macro.</dd><dt><a class="macro" href="macro.log_enabled.html" title="macro micromegas_tracing::log_enabled">log_<wbr>enabled</a></dt><dd>Determines if a message logged at the specified level in that module will
be logged.</dd><dt><a class="macro" href="macro.span_async_named.html" title="macro micromegas_tracing::span_async_named">span_<wbr>async_<wbr>named</a></dt><dd>Instruments an async block with a named span using a static string.
This creates both the SpanLocation and instruments the future in one macro call.</dd><dt><a class="macro" href="macro.span_scope.html" title="macro micromegas_tracing::span_scope">span_<wbr>scope</a></dt><dd>Records a sync span as two thread events</dd><dt><a class="macro" href="macro.span_scope_named.html" title="macro micromegas_tracing::span_scope_named">span_<wbr>scope_<wbr>named</a></dt><dd>Records a span with a name that is determined at runtime.
The span name still needs to be statically allocated.</dd><dt><a class="macro" href="macro.static_span_desc.html" title="macro micromegas_tracing::static_span_desc">static_<wbr>span_<wbr>desc</a></dt><dt><a class="macro" href="macro.static_span_location.html" title="macro micromegas_tracing::static_span_location">static_<wbr>span_<wbr>location</a></dt><dd>Creates a static SpanLocation for use with named async spans.
This is an internal implementation detail - users should use <code>instrument_named!</code> instead.</dd><dt><a class="macro" href="macro.trace.html" title="macro micromegas_tracing::trace">trace</a></dt><dd>Logs a message at the trace level.</dd><dt><a class="macro" href="macro.warn.html" title="macro micromegas_tracing::warn">warn</a></dt><dd>Logs a message at the warn level.</dd></dl><script type="text/json" id="notable-traits-data">{"&[u8]":"<h3>Notable traits for <code>&amp;[<a class=\"primitive\" href=\"https://doc.rust-lang.org/1.93.1/std/primitive.u8.html\">u8</a>]</code></h3><pre><code><div class=\"where\">impl <a class=\"trait\" href=\"https://doc.rust-lang.org/1.93.1/std/io/trait.Read.html\" title=\"trait std::io::Read\">Read</a> for &amp;[<a class=\"primitive\" href=\"https://doc.rust-lang.org/1.93.1/std/primitive.u8.html\">u8</a>]</div>"}</script></section></div></main></body></html>